<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bind in JS</title>
  </head>
  <style>
    :root {
      --bg: #f8fafc;
      --card-bg: #ffffff;
      --text: #0f172a;
      --muted: #475569;
      --border: #e2e8f0;
      --accent: #1f688d;
      --accent-600: #195471;
      --accent-700: #15465e;
      --ring: #93c5fd;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0b1220;
        --card-bg: #111827;
        --text: #e5e7eb;
        --muted: #94a3b8;
        --border: #243043;
        --accent: #2d8db6;
        --accent-600: #25779a;
        --accent-700: #1d607d;
        --ring: #2563eb;
      }
    }

    /* Page baseline */
    html,
    body {
      height: 100%;
    }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font: 400 16px/1.65 system-ui, -apple-system, "Segoe UI", Roboto, Inter,
        "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji",
        "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Layout */
    .button {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding-top: 16px;
    }
    .text {
      width: 100%;
      margin-top: 24px;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 0 16px;
      box-sizing: border-box;
    }
    .text span {
      display: block;
      width: 100%;
      max-width: 860px;
      padding: 20px 24px;
      border: 1px solid var(--border);
      border-radius: 14px;
      background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.6),
          rgba(255, 255, 255, 0.2)
        ),
        var(--card-bg);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.06), 0 2px 6px rgba(0, 0, 0, 0.06);
    }

    /* Headings & text rhythm */
    h3 {
      margin: 20px 0 10px;
      font-size: 1.05rem;
      line-height: 1.35;
      font-weight: 700;
      letter-spacing: 0.2px;
    }
    p {
      margin: 10px 0;
      color: var(--text);
    }
    ul,
    ol {
      margin: 10px 0 14px 24px;
      color: var(--text);
    }
    li {
      margin: 6px 0;
    }
    small {
      color: var(--muted);
    }

    /* Buttons */
    button {
      padding: 10px 16px;
      margin-top: 8px;
      font-size: 16px;
      color: #fff;
      background-color: var(--accent);
      border: 1px solid color-mix(in oklab, var(--accent) 60%, #000 10%);
      border-radius: 12px;
      cursor: pointer;
      transition: transform 0.06s ease, box-shadow 0.2s ease,
        background-color 0.2s ease, border-color 0.2s ease;
      box-shadow: 0 10px 18px rgba(31, 104, 141, 0.18),
        0 2px 4px rgba(0, 0, 0, 0.1);
    }
    button:hover {
      background-color: var(--accent-600);
      transform: translateY(-1px);
      box-shadow: 0 12px 22px rgba(31, 104, 141, 0.22),
        0 3px 6px rgba(0, 0, 0, 0.12);
    }
    button:active {
      transform: translateY(0);
      box-shadow: 0 6px 12px rgba(31, 104, 141, 0.16),
        0 2px 4px rgba(0, 0, 0, 0.1);
    }
    button:focus-visible {
      outline: none;
      box-shadow: 0 0 0 3px var(--ring), 0 8px 16px rgba(31, 104, 141, 0.2);
    }

    /* Code & pre */
    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
      font-size: 0.95rem;
      padding: 2px 6px;
      border-radius: 8px;
      background: color-mix(in oklab, var(--card-bg) 80%, #9aa4b2 20%);
      color: var(--text);
    }
    pre {
      margin: 10px 0 14px;
      padding: 12px 14px;
      background: color-mix(in oklab, var(--card-bg) 72%, #9aa4b2 28%);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: auto;
    }
    pre code {
      padding: 0;
      background: transparent;
      font-size: 0.92rem;
      line-height: 1.6;
      display: block;
      white-space: pre;
    }

    /* Inline helpers */
    strong {
      font-weight: 700;
      color: var(--text);
    }
    em {
      color: var(--muted);
    }
  </style>

  <body>
    <div class="button"><button>Button Clicked</button></div>
    <div class="text">
      <span>
        <h3>
          Understanding <code>bind()</code> in JavaScript (with our button
          example)
        </h3>

        <p>
          <strong>Goal:</strong> When the button is clicked, we want
          <code>handleClick()</code> to log the class’s own data (e.g.,
          <code>this.server</code>) instead of the button element.
        </p>

        <h3>Scenario</h3>
        <p>
          We have a <code>Library</code> class with properties like
          <code>this.library</code> and <code>this.server</code>, and a method
          <code>handleClick()</code>. In the constructor we attach a click
          listener to the button.
        </p>

        <h3>What’s the problem?</h3>
        <p>If we pass the method reference directly:</p>
        <pre><code>document.querySelector("button").addEventListener("click", this.handleClick);</code></pre>
        <p>
          then inside <code>handleClick()</code>, <code>this</code> becomes the
          <em>button element</em> (because the DOM calls listeners with
          <code>this === currentTarget</code>). As a result,
          <code>this.server</code> is <code>undefined</code>.
        </p>

        <h3>Why does this happen? (the core idea)</h3>
        <ul>
          <li>
            <code>this</code> in JavaScript depends on <em>how</em> a function
            is called.
          </li>
          <li>
            The DOM event system calls listeners with <code>this</code> set to
            the element that fired the event.
          </li>
          <li>
            So if you pass a bare function (like <code>this.handleClick</code>),
            the browser decides its <code>this</code> later → the button.
          </li>
        </ul>

        <h3>
          The fix: <code>bind()</code> (glue the right <code>this</code> ahead
          of time)
        </h3>
        <p>
          <code>bind(this)</code> returns a <em>new function</em> where
          <code>this</code> is permanently set to your
          <code>Library</code> instance. Now the DOM can call it later, but it
          can’t change the bound <code>this</code>.
        </p>
        <pre><code>document.querySelector("button")
        .addEventListener("click", this.handleClick.bind(this));</code></pre>
        <p>
          Inside <code>handleClick()</code>, <code>this</code> is now your class
          instance, so <code>this.server</code> logs correctly.
        </p>

        <h3>
          Best practice: store the bound function if you might remove it later
        </h3>
        <pre><code>this.onClick = this.handleClick.bind(this);
      document.querySelector("button").addEventListener("click", this.onClick);
      /* later */
      // document.querySelector("button").removeEventListener("click", this.onClick);</code></pre>
        <p>
          <em>Why?</em> Every call to <code>bind</code> creates a new function.
          To remove a listener you need the <strong>same reference</strong> you
          added.
        </p>

        <h3>Alternatives (when you don’t want to use <code>bind</code>)</h3>
        <ul>
          <li>
            Arrow wrapper (captures surrounding <code>this</code>):
            <pre><code>addEventListener("click", (e) =&gt; this.handleClick(e));</code></pre>
          </li>
          <li>
            Class field arrow method (per-instance method that keeps
            <code>this</code>):
            <pre><code>class Library {
        handleClick = (e) =&gt; { console.log(this.server); }
        constructor() { document.querySelector("button").addEventListener("click", this.handleClick); }
      }</code></pre>
          </li>
        </ul>

        <h3>Key takeaways</h3>
        <ul>
          <li>
            Event listeners run with <code>this</code> set to the element by
            default.
          </li>
          <li>
            <code>bind(this)</code> creates a new function with your class
            instance “glued” as <code>this</code>.
          </li>
          <li>Store the bound function if you’ll remove the listener later.</li>
          <li>
            Arrow wrappers and class field arrows are valid alternatives that
            also preserve <code>this</code>.
          </li>
        </ul>

        <h3>Mini-quiz (check your understanding)</h3>
        <ol>
          <li>
            If you remove <code>.bind(this)</code>, what is
            <code>this</code> inside <code>handleClick</code>?
          </li>
          <li>
            What’s the difference between <code>bind</code> and
            <code>call</code>?
          </li>
          <li>
            How would you pass a label along with the event using
            <code>bind</code>? <br /><small
              >(Hint:
              <code
                >addEventListener("click", this.handleClick.bind(this,
                "clicked"))</code
              >
              → <code>handleClick(label, event)</code>)</small
            >
          </li>
        </ol>
      </span>
    </div>
  </body>
  <script>
    class Library {
      constructor() {
        this.library = "JS Library";
        this.server = "http://127.0.0.1:5500/6_OOP/bind.html";
        document
          .querySelector("button")
          .addEventListener("click", this.handleClick.bind(this));
      }
      handleClick() {
        console.log("Button Click");
        console.log("Server: " + this.server);
      }
    }

    const app = new Library();
  </script>
</html>
